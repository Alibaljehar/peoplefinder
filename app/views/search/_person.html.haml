.search-result
  .grid-wrapper
    .grid
      .inner-block
        .image-background
          = profile_image_tag person
        .details
          / # - index = person_counter.index
          - @index ||= 0
          - @index += 1
          - if search_result
            %h3.search-result-name
              - if (hit&.highlight&.name rescue false)
                = link_to hit.highlight.name.join.html_safe, person, { data: search_result_analytics_attributes(@index) }
              - elsif hit
                = link_to person.name, person, { data: search_result_analytics_attributes(@index) }
              - else
                = link_to person.name, person, { data: search_result_analytics_attributes(@index) }

          - else
            %h3.search-result-name
              = link_to person.name, person

          - if person.memberships.empty?
            .meta
          - else
            - person.memberships.each do |membership|
              .meta
                = "#{ membership.role }, " if membership.role?
                - if (hit&.highlight&.role_and_group rescue false)
                  = link_to hit.highlight.role_and_group.join.html_safe,
                    membership.group,
                    search_result ? { data: search_result_analytics_attributes(@index) } : {}
                - else
                  = link_to membership.group.name, membership.group,
                    search_result ? { data: search_result_analytics_attributes(@index) } : {}

          .meta
            = call_to(person.phone)
          .meta
            - if (hit&.highlight&.email rescue false)
              = mail_to(hit.highlight.email.join.html_safe, nil, data: search_result_analytics_attributes(@index) )
            -else
              = mail_to(person.email, nil, data: search_result_analytics_attributes(@index) )
          - if person.current_project.present?
            .meta
              Current project(s):
              = person.current_project

        - if ['sessions', 'tokens', 'people'].include? controller_name
          .select-person
            = form_for person, url: update_email_person_path(person) do |f|
              = f.hidden_field :email, value: @person.email
              = f.submit 'Select', class: 'button'

      - if hit && (Rails.env.development? || current_user.super_admin?)
        %span{style: "float: right; font-size: 10px;"}
          Score:
          = hit._score
